{% extends "base.html" %}

{% block title %}My Courses - Classroom Interaction Platform{% endblock %}

{% block content %}
<style>
.course-card {
        transition: all 0.3s ease;
        border: none;
        border-radius: 15px;
        overflow: hidden;
        background: #ffffff; /* 外层白色框 */
        box-shadow: 0 6px 18px rgba(12,45,80,0.04);
}

.course-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(0,0,0,0.08);
}

/* 内部小模块，带自身渐变色 */
.course-inner {
    margin: 14px; /* 让内部模块在白色外框内留白 */
    border-radius: 12px;
    padding: 18px;
    box-sizing: border-box;
    height: 260px; /* 固定高度，保证所有卡片一致 */
    overflow: hidden;
    position: relative; /* 允许内部绝对定位或预留底部空间 */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    color: #153d5a; /* 深灰色文本，适配浅色渐变 */
    transition: all 0.25s ease;
}

/* 多彩渐变背景 - 应用于小模块 */
.course-inner.course-color-1 { background: linear-gradient(135deg, #f0f9f0 0%, #e8f5e8 50%, #e0f0e0 100%); }
.course-inner.course-color-2 { background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 50%, #ffd9d9 100%); }
.course-inner.course-color-3 { background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 50%, #ddeeff 100%); }
.course-inner.course-color-4 { background: linear-gradient(135deg, #fffef0 0%, #fffae6 50%, #fff6dc 100%); }
.course-inner.course-color-5 { background: linear-gradient(135deg, #faf5ff 0%, #f5ebff 50%, #f0e1ff 100%); }
.course-inner.course-color-6 { background: linear-gradient(135deg, #fff8f0 0%, #fff2e6 50%, #ffebdc 100%); }

.course-inner.course-color-1:hover { filter: brightness(0.98); }
.course-inner.course-color-2:hover { filter: brightness(0.98); }
.course-inner.course-color-3:hover { filter: brightness(0.98); }
.course-inner.course-color-4:hover { filter: brightness(0.98); }
.course-inner.course-color-5:hover { filter: brightness(0.98); }
.course-inner.course-color-6:hover { filter: brightness(0.98); }

.course-card .card-footer { padding: 14px; height: 72px; }

/* 预留内部底部空间，防止内容覆盖 Footer，并保持按钮垂直对齐 */
.course-inner .card-body { padding-bottom: 72px; }

/* 文本截断以节省空间 */
.course-desc {
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    overflow: hidden;
    color: #5a6570;
}

@media (max-width: 576px) {
    .course-inner { height: auto; }
    .course-card .card-footer { height: auto; }
    .course-inner .card-body { padding-bottom: 14px; }
}
</style>

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="bi bi-book"></i> My Courses</h2>
    <a href="{{ url_for('courses.browse_courses') }}" class="btn btn-primary">
        <i class="bi bi-search"></i> Browse More Courses
    </a>
</div>

{% if courses %}
    <div class="row">
        {% for course in courses %}
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100 course-card">
                <div class="course-inner course-color-{{ (loop.index - 1) % 6 + 1 }}">
                    <div class="card-body p-0">
                        <h5 class="card-title mb-3" style="color: inherit;">{{ course.name }}</h5>
                        <p class="card-text">
                            <small class="text-muted">
                                <i class="bi bi-calendar"></i> {{ course.semester }} <br>
                                <i class="bi bi-person"></i> {{ course.instructor.name }}
                            </small>
                        </p>
                        {% if course.description %}
                            <p class="card-text mt-3 course-desc">{{ course.description[:100] }}{% if course.description|length > 100 %}...{% endif %}</p>
                        {% endif %}
                    </div>
                </div>
                <div class="card-footer bg-transparent">
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('courses.course_detail', course_id=course.id) }}" class="btn btn-primary">
                            <i class="bi bi-arrow-right-circle"></i> Enter Course
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <!-- Pagination -->
    {% if pagination and pagination.pages > 1 %}
    <nav aria-label="Course pagination">
        <ul class="pagination justify-content-center">
            <!-- Previous Page -->
            <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
                <a class="page-link" href="{{ url_for('courses.list_courses', page=pagination.prev_num) if pagination.has_prev else '#' }}">
                    <i class="bi bi-chevron-left"></i> Previous
                </a>
            </li>
            
            <!-- Page Numbers -->
            {% for page_num in range(1, pagination.pages + 1) %}
                {% if page_num == pagination.page %}
                    <li class="page-item active">
                        <span class="page-link">{{ page_num }}</span>
                    </li>
                {% elif page_num == 1 or page_num == pagination.pages or (page_num >= pagination.page - 1 and page_num <= pagination.page + 1) %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('courses.list_courses', page=page_num) }}">{{ page_num }}</a>
                    </li>
                {% elif page_num == pagination.page - 2 or page_num == pagination.page + 2 %}
                    <li class="page-item disabled">
                        <span class="page-link">...</span>
                    </li>
                {% endif %}
            {% endfor %}
            
            <!-- Next Page -->
            <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
                <a class="page-link" href="{{ url_for('courses.list_courses', page=pagination.next_num) if pagination.has_next else '#' }}">
                    Next <i class="bi bi-chevron-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    {% endif %}
    
{% else %}
    <div class="text-center py-5">
        <i class="bi bi-book display-1 text-muted"></i>
        <h3 class="text-muted mt-3">You have not selected any courses</h3>
        <p class="text-muted">Browse the course list and enroll in courses of interest</p>
        <a href="{{ url_for('courses.browse_courses') }}" class="btn btn-primary">
            <i class="bi bi-search"></i> Browse Courses
        </a>
    </div>
{% endif %}
{% endblock %}
